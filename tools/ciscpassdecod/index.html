<html>
  <head>
    <title>Cisco VPN Client Password Decoder</title>
    <script src="https://cdn.rawgit.com/artemkin/cisco-password-decoder/v1.0/forge.min.js" type="text/javascript"></script>
    <script src="https://cdn.rawgit.com/artemkin/cisco-password-decoder/v1.0/cisco-decrypt.js" type="text/javascript"></script>
    <script>
      var encrypted = "";

      function lookForEncryptedChange() {
          var newEncrypted = document.getElementById("encrypted").value.trim();
          if (newEncrypted != encrypted) {
              encrypted = newEncrypted;
              var decrypted = decryptPassword(encrypted);
              if (newEncrypted != "") {
                if (decrypted != "") {
                  decrypted = "Password: " + decrypted;
                } else {
                  decrypted = "Wrong encrypted password";
                }
              } else {
                decrypted = "&nbsp;";
              }
              document.getElementById("decrypted").innerHTML = decrypted;
          }
      }

      setInterval(lookForEncryptedChange, 100);
    </script>
  </head>
  <body>
    <h1>Cisco VPN Client Password Decoder</h1>
    <form action="javascript:void(0);">
      Encrypted Group Password <input type="text" size="90" id="encrypted" name="encrypted"/>
    </form>
    <p id="decrypted">&nbsp;</p>
  </body>
</html>

